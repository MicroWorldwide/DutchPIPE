<table border="0" cellpadding="0" cellspacing="0" style="width: 98%">
  <tr valign="top">
    <td class="menu">
                        <br />
            <br />
              <div class="package">
                    <a href="../ric_INSTALL.html">INSTALL</a>&nbsp;|
                    <a href="../ric_LICENSE.html">LICENSE</a>&nbsp;|
                    <a href="../ric_README.html">README</a>&nbsp;|
                    <a href="../todolist.html">Todo List</a>&nbsp;|
        <a href="../classtrees_DutchPIPE.html">Class Tree</a>&nbsp;|
        <a href="../elementindex_DutchPIPE.html">Index</a>
        </div>
    </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">
<span id="gototop" style="position:absolute;z-index:100"><a href="javascript:window.scrollTo(0,0)"><img id="buttop" src="/images/top.gif" width="11" height="11" border="0" alt="Go to Top" title="Go to Top" /></a></span>
<script src="/jumptop.js"></script>
<h1>Source for file dpserver.php</h1>
<p>Documentation is available at <a href="../DutchPIPE/lib/_lib---dpserver.php.html">dpserver.php</a></p>
<div class="src-code"><span class="php">
<ol class="src-bg"><li class="src-li"><div class="src-line"><a name="a1"></a><span class="src-php">&lt;?php</span></div></li>
<li class="src-li"><div class="src-line"><a name="a2"></a><span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a3"></a><span class="src-doc">&nbsp;*&nbsp;Provides&nbsp;'DpServer'&nbsp;class&nbsp;to&nbsp;answer&nbsp;normal&nbsp;and&nbsp;AJAX&nbsp;requests&nbsp;from&nbsp;web&nbsp;clients</span></div></li>
<li class="src-li"><div class="src-line"><a name="a4"></a><span class="src-doc">&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a5"></a><span class="src-doc">&nbsp;*&nbsp;DutchPIPE&nbsp;version&nbsp;0.1;&nbsp;PHP&nbsp;version&nbsp;5</span></div></li>
<li class="src-li"><div class="src-line"><a name="a6"></a><span class="src-doc">&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a7"></a><span class="src-doc">&nbsp;*&nbsp;LICENSE:&nbsp;This&nbsp;source&nbsp;file&nbsp;is&nbsp;subject&nbsp;to&nbsp;version&nbsp;1.0&nbsp;of&nbsp;the&nbsp;DutchPIPE&nbsp;license.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a8"></a><span class="src-doc">&nbsp;*&nbsp;If&nbsp;you&nbsp;did&nbsp;not&nbsp;receive&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;DutchPIPE&nbsp;license,&nbsp;you&nbsp;can&nbsp;obtain&nbsp;one&nbsp;at</span></div></li>
<li class="src-li"><div class="src-line"><a name="a9"></a><span class="src-doc">&nbsp;*&nbsp;http://dutchpipe.org/license/1_0.txt&nbsp;or&nbsp;by&nbsp;sending&nbsp;a&nbsp;note&nbsp;to</span></div></li>
<li class="src-li"><div class="src-line"><a name="a10"></a><span class="src-doc">&nbsp;*&nbsp;license@dutchpipe.org,&nbsp;in&nbsp;which&nbsp;case&nbsp;you&nbsp;will&nbsp;be&nbsp;mailed&nbsp;a&nbsp;copy&nbsp;immediately.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a11"></a><span class="src-doc">&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a12"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@package</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;DutchPIPE</span></div></li>
<li class="src-li"><div class="src-line"><a name="a13"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@subpackage</span><span class="src-doc">&nbsp;lib</span></div></li>
<li class="src-li"><div class="src-line"><a name="a14"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@author</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lennert&nbsp;Stock&nbsp;&lt;ls@dutchpipe.org&gt;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a15"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@copyright</span><span class="src-doc">&nbsp;&nbsp;2006&nbsp;Lennert&nbsp;Stock</span></div></li>
<li class="src-li"><div class="src-line"><a name="a16"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@license</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;http://dutchpipe.org/license/1_0.txt&nbsp;&nbsp;DutchPIPE&nbsp;License</span></div></li>
<li class="src-li"><div class="src-line"><a name="a17"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@version</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;Subversion:&nbsp;$Id:&nbsp;dpserver.php&nbsp;77&nbsp;2006-07-13&nbsp;20:39:04Z&nbsp;ls&nbsp;$</span></div></li>
<li class="src-li"><div class="src-line"><a name="a18"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@link</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://dutchpipe.org/manual/package/DutchPIPE</span></div></li>
<li class="src-li"><div class="src-line"><a name="a19"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@see</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpclient.php,&nbsp;dpuniverse.php</span></div></li>
<li class="src-li"><div class="src-line"><a name="a20"></a><span class="src-doc">&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a21"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a22"></a><span class="src-doc">/*&nbsp;Shows&nbsp;all&nbsp;possible&nbsp;errors&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a23"></a><a href="http://www.php.net/error_reporting">error_reporting</a><span class="src-sym">(</span><span class="src-id">E_ALL&nbsp;</span>|&nbsp;<span class="src-id">E_STRICT</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a24"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a25"></a><span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a26"></a><span class="src-doc">&nbsp;*&nbsp;A&nbsp;DutchPIPE&nbsp;server&nbsp;to&nbsp;answer&nbsp;normal&nbsp;and&nbsp;AJAX&nbsp;requests&nbsp;from&nbsp;web&nbsp;clients</span></div></li>
<li class="src-li"><div class="src-line"><a name="a27"></a><span class="src-doc">&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a28"></a><span class="src-doc">&nbsp;*&nbsp;The&nbsp;DutchPIPE&nbsp;server&nbsp;which&nbsp;can&nbsp;be&nbsp;started&nbsp;and&nbsp;then&nbsp;keeps&nbsp;running&nbsp;while</span></div></li>
<li class="src-li"><div class="src-line"><a name="a29"></a><span class="src-doc">&nbsp;*&nbsp;accepting&nbsp;socket&nbsp;connections.&nbsp;Waits&nbsp;for&nbsp;and&nbsp;accepts&nbsp;socket&nbsp;requests&nbsp;from</span></div></li>
<li class="src-li"><div class="src-line"><a name="a30"></a><span class="src-doc">&nbsp;*&nbsp;users&nbsp;connected&nbsp;through&nbsp;dpclient.php,&nbsp;and&nbsp;returns&nbsp;output&nbsp;to&nbsp;dpclient.php,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a31"></a><span class="src-doc">&nbsp;*&nbsp;which&nbsp;returns&nbsp;it&nbsp;to&nbsp;the&nbsp;end&nbsp;user.&nbsp;If&nbsp;there&nbsp;are&nbsp;10&nbsp;users&nbsp;on&nbsp;the&nbsp;site,&nbsp;it&nbsp;will</span></div></li>
<li class="src-li"><div class="src-line"><a name="a32"></a><span class="src-doc">&nbsp;*&nbsp;loop&nbsp;through&nbsp;the&nbsp;main&nbsp;code&nbsp;for&nbsp;each&nbsp;user&nbsp;at&nbsp;a&nbsp;time.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a33"></a><span class="src-doc">&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a34"></a><span class="src-doc">&nbsp;*&nbsp;To&nbsp;answer&nbsp;each&nbsp;request,&nbsp;the&nbsp;server&nbsp;passes&nbsp;the&nbsp;request&nbsp;on&nbsp;to&nbsp;the&nbsp;persistent</span></div></li>
<li class="src-li"><div class="src-line"><a name="a35"></a><span class="src-doc">&nbsp;*&nbsp;DbUniverse&nbsp;object,&nbsp;where&nbsp;the&nbsp;real&nbsp;processing&nbsp;takes&nbsp;place.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a36"></a><span class="src-doc">&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a37"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@package</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;DutchPIPE</span></div></li>
<li class="src-li"><div class="src-line"><a name="a38"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@subpackage</span><span class="src-doc">&nbsp;lib</span></div></li>
<li class="src-li"><div class="src-line"><a name="a39"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@author</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lennert&nbsp;Stock&nbsp;&lt;ls@dutchpipe.org&gt;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a40"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@copyright</span><span class="src-doc">&nbsp;&nbsp;2006&nbsp;Lennert&nbsp;Stock</span></div></li>
<li class="src-li"><div class="src-line"><a name="a41"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@license</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;http://dutchpipe.org/license/1_0.txt&nbsp;&nbsp;DutchPIPE&nbsp;License</span></div></li>
<li class="src-li"><div class="src-line"><a name="a42"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@version</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;Release:&nbsp;@package_version@</span></div></li>
<li class="src-li"><div class="src-line"><a name="a43"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@link</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://dutchpipe.org/manual/package/DutchPIPE</span></div></li>
<li class="src-li"><div class="src-line"><a name="a44"></a><span class="src-doc">&nbsp;*&nbsp;</span><span class="src-doc-coretag">@see</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpclient.php,&nbsp;dpuniverse.php</span></div></li>
<li class="src-li"><div class="src-line"><a name="a45"></a><span class="src-doc">&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a46"></a><span class="src-key">final&nbsp;</span><span class="src-key">class&nbsp;</span><a href="../DutchPIPE/lib/DpServer.html">DpServer</a></div></li>
<li class="src-li"><div class="src-line"><a name="a47"></a><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a48"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a49"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@var&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">resource&nbsp;</span><span class="src-doc">&nbsp;The&nbsp;socket&nbsp;the&nbsp;server&nbsp;has&nbsp;opened&nbsp;to&nbsp;a&nbsp;client</span></div></li>
<li class="src-li"><div class="src-line"><a name="a50"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@access</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private</span></div></li>
<li class="src-li"><div class="src-line"><a name="a51"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a52"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-var">$mMsgsock</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a53"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a54"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a55"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@var&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">resource&nbsp;</span><span class="src-doc">&nbsp;Used&nbsp;to&nbsp;show&nbsp;server&nbsp;status&nbsp;info&nbsp;on&nbsp;the&nbsp;command&nbsp;line</span></div></li>
<li class="src-li"><div class="src-line"><a name="a56"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@access</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private</span></div></li>
<li class="src-li"><div class="src-line"><a name="a57"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a58"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-var">$mShowedStatusHeader&nbsp;</span>=&nbsp;<span class="src-num">0</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a59"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a60"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a61"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Used&nbsp;to&nbsp;show&nbsp;server&nbsp;status&nbsp;info&nbsp;based&nbsp;on&nbsp;getrusage,&nbsp;start&nbsp;&quot;user&quot;&nbsp;time&nbsp;of</span></div></li>
<li class="src-li"><div class="src-line"><a name="a62"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;script</span></div></li>
<li class="src-li"><div class="src-line"><a name="a63"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a64"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@var&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">resource&nbsp;</span><span class="src-doc">&nbsp;Start&nbsp;'user'&nbsp;time&nbsp;of&nbsp;script</span></div></li>
<li class="src-li"><div class="src-line"><a name="a65"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@access</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private</span></div></li>
<li class="src-li"><div class="src-line"><a name="a66"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a67"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-var">$mUtimeBefore</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a68"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a69"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a70"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Used&nbsp;to&nbsp;show&nbsp;server&nbsp;status&nbsp;info&nbsp;based&nbsp;on&nbsp;getrusage,&nbsp;start&nbsp;&quot;system&quot;&nbsp;time</span></div></li>
<li class="src-li"><div class="src-line"><a name="a71"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;of&nbsp;script</span></div></li>
<li class="src-li"><div class="src-line"><a name="a72"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a73"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@var&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">resource&nbsp;</span><span class="src-doc">&nbsp;Start&nbsp;&quot;system&quot;&nbsp;time&nbsp;of&nbsp;script</span></div></li>
<li class="src-li"><div class="src-line"><a name="a74"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@access</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private</span></div></li>
<li class="src-li"><div class="src-line"><a name="a75"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a76"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-var">$mStimeBefore</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a77"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a78"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a79"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;up&nbsp;the&nbsp;server&nbsp;at&nbsp;object&nbsp;creation&nbsp;time&nbsp;based&nbsp;on&nbsp;your&nbsp;settings</span></div></li>
<li class="src-li"><div class="src-line"><a name="a80"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a81"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@param&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">string&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;</span><span class="src-doc-var">$iniFile&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;Path&nbsp;to&nbsp;a&nbsp;dpserver-ini.php&nbsp;like&nbsp;file</span></div></li>
<li class="src-li"><div class="src-line"><a name="a82"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a83"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../DutchPIPE/lib/DpServer.html#method__construct">__construct</a><span class="src-sym">(</span><span class="src-var">$iniFile&nbsp;</span>=&nbsp;<span class="src-str">'dpserver-ini.php'</span><span class="src-sym">)</span></div></li>
<li class="src-li"><div class="src-line"><a name="a84"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a85"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Used&nbsp;by&nbsp;showStatus()&nbsp;further&nbsp;below&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a86"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><a href="http://www.php.net/function_exists">function_exists</a><span class="src-sym">(</span><span class="src-str">'getrusage'</span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a87"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$rusage&nbsp;</span>=&nbsp;<a href="http://www.php.net/getrusage">getrusage</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a88"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mUtimeBefore&nbsp;</span>=&nbsp;(int)<span class="src-var">$rusage</span><span class="src-sym">[</span><span class="src-str">&quot;ru_utime.tv_sec&quot;</span><span class="src-sym">]&nbsp;</span>*&nbsp;<span class="src-num">1e6&nbsp;</span>+</div></li>
<li class="src-li"><div class="src-line"><a name="a89"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(int)<span class="src-var">$rusage</span><span class="src-sym">[</span><span class="src-str">&quot;ru_utime.tv_usec&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a90"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mStimeBefore&nbsp;</span>=&nbsp;(int)<span class="src-var">$rusage</span><span class="src-sym">[</span><span class="src-str">&quot;ru_stime.tv_sec&quot;</span><span class="src-sym">]&nbsp;</span>*&nbsp;<span class="src-num">1e6&nbsp;</span>+</div></li>
<li class="src-li"><div class="src-line"><a name="a91"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(int)<span class="src-var">$rusage</span><span class="src-sym">[</span><span class="src-str">&quot;ru_stime.tv_usec&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a92"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a93"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a94"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Get&nbsp;the&nbsp;server&nbsp;settings&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a95"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-var">$iniFile</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a96"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a97"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/error_reporting">error_reporting</a><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_ERROR_REPORTING">DPSERVER_ERROR_REPORTING</a></span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a98"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a99"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Allow&nbsp;the&nbsp;script&nbsp;to&nbsp;hang&nbsp;around&nbsp;waiting&nbsp;for&nbsp;connections&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a100"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/set_time_limit">set_time_limit</a><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_MAXUPTIME">DPSERVER_MAXUPTIME</a></span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a101"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a102"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;See&nbsp;what&nbsp;we're&nbsp;getting&nbsp;as&nbsp;it&nbsp;comes&nbsp;in&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a103"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/ob_implicit_flush">ob_implicit_flush</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a104"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a105"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/date_default_timezone_set">date_default_timezone_set</a><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_TIMEZONE">DPSERVER_TIMEZONE</a></span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a106"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a107"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a108"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a109"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Starts&nbsp;the&nbsp;DutchPIPE&nbsp;server,&nbsp;using&nbsp;a&nbsp;specific&nbsp;'universe'&nbsp;object</span></div></li>
<li class="src-li"><div class="src-line"><a name="a110"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a111"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Also&nbsp;see:&nbsp;http://www.php.net/sockets</span></div></li>
<li class="src-li"><div class="src-line"><a name="a112"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a113"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@param&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">object&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;</span><span class="src-doc-var">&amp;$universe&nbsp;</span><span class="src-doc">&nbsp;&nbsp;An&nbsp;instance&nbsp;of&nbsp;DpUniverse</span></div></li>
<li class="src-li"><div class="src-line"><a name="a114"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a115"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../DutchPIPE/lib/DpServer.html#methodrunDpServer">runDpServer</a><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$universe</span><span class="src-sym">)</span></div></li>
<li class="src-li"><div class="src-line"><a name="a116"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a117"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Check&nbsp;if&nbsp;the&nbsp;server&nbsp;is&nbsp;already&nbsp;running&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a118"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><a href="http://www.php.net/file_exists">file_exists</a><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_PATH">DPSERVER_SOCKET_PATH</a></span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a119"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;:KLUDGE:&nbsp;should&nbsp;be&nbsp;improved&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a120"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/unlink">unlink</a><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_PATH">DPSERVER_SOCKET_PATH</a></span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a121"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//die(dptext(&quot;Cannot&nbsp;start&nbsp;server:&nbsp;server&nbsp;already&nbsp;running\n&quot;));</span></div></li>
<li class="src-li"><div class="src-line"><a name="a122"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a123"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a124"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_TYPE">DPSERVER_SOCKET_TYPE</a>&nbsp;</span>===&nbsp;<span class="src-id">AF_UNIX</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a125"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Initialize&nbsp;the&nbsp;server,&nbsp;first&nbsp;create&nbsp;a&nbsp;socket&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a126"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$socket&nbsp;</span>=&nbsp;<a href="http://www.php.net/socket_create">socket_create</a><span class="src-sym">(</span><span class="src-id">AF_UNIX</span><span class="src-sym">,&nbsp;</span><span class="src-id">SOCK_STREAM</span><span class="src-sym">,&nbsp;</span><span class="src-num">0</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a127"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a128"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;socket_create():&nbsp;unable&nbsp;to&nbsp;create&nbsp;socket&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a129"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">))))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a130"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a131"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a132"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Bind&nbsp;the&nbsp;socket&nbsp;to&nbsp;a&nbsp;file,&nbsp;for&nbsp;example&nbsp;/tmp/dutchpipesock&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a133"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<a href="http://www.php.net/socket_bind">socket_bind</a><span class="src-sym">(</span><span class="src-var">$socket</span><span class="src-sym">,&nbsp;</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_PATH">DPSERVER_SOCKET_PATH</a></span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a134"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a135"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;socket_bind()&nbsp;unable&nbsp;to&nbsp;bind&nbsp;socket&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a136"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">))))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a137"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a138"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<a href="http://www.php.net/chmod">chmod</a><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_PATH">DPSERVER_SOCKET_PATH</a></span><span class="src-sym">,&nbsp;</span><span class="src-num">0777</span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a139"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a140"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;Cannot&nbsp;start&nbsp;server:&nbsp;reason:&nbsp;chmod&nbsp;on&nbsp;%s&nbsp;failed\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a141"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_PATH">DPSERVER_SOCKET_PATH</a></span><span class="src-sym">))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a142"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a143"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">elseif&nbsp;</span><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_TYPE">DPSERVER_SOCKET_TYPE</a>&nbsp;</span>===&nbsp;<span class="src-id">AF_INET</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a144"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Initialize&nbsp;the&nbsp;server,&nbsp;first&nbsp;create&nbsp;a&nbsp;socket&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a145"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$socket&nbsp;</span>=&nbsp;<a href="http://www.php.net/socket_create">socket_create</a><span class="src-sym">(</span><span class="src-id">AF_INET</span><span class="src-sym">,&nbsp;</span><span class="src-id">SOCK_STREAM</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a146"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-id">SOL_TCP</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a147"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a148"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;socket_create():&nbsp;unable&nbsp;to&nbsp;create&nbsp;socket&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a149"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">))))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a150"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a151"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a152"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Bind&nbsp;the&nbsp;socket&nbsp;to&nbsp;a&nbsp;file,&nbsp;for&nbsp;example&nbsp;/tmp/dutchpipesock&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a153"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<a href="http://www.php.net/socket_bind">socket_bind</a><span class="src-sym">(</span><span class="src-var">$socket</span><span class="src-sym">,&nbsp;</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_ADDRESS">DPSERVER_SOCKET_ADDRESS</a></span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a154"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_PORT">DPSERVER_SOCKET_PORT</a></span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a155"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a156"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;socket_bind()&nbsp;unable&nbsp;to&nbsp;bind&nbsp;socket&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a157"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">))))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a158"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a159"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a160"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;Invalid&nbsp;socket&nbsp;protocol.\n&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a161"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a162"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Start&nbsp;listening&nbsp;to&nbsp;the&nbsp;socket&nbsp;which&nbsp;dpclient.php&nbsp;talks&nbsp;to&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a163"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<a href="http://www.php.net/socket_listen">socket_listen</a><span class="src-sym">(</span><span class="src-var">$socket</span><span class="src-sym">,&nbsp;</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_MAX_SOCKET_BACKLOG">DPSERVER_MAX_SOCKET_BACKLOG</a></span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a164"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">die</span><span class="src-sym">(</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;socket_listen():&nbsp;failure&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a165"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">))))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a166"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a167"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a168"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Accept&nbsp;connections&nbsp;and&nbsp;loop&nbsp;for&nbsp;each&nbsp;request&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a169"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a170"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock&nbsp;</span>=&nbsp;<a href="http://www.php.net/socket_accept">socket_accept</a><span class="src-sym">(</span><span class="src-var">$socket</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a171"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;socket_accept():&nbsp;failure&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a172"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a173"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a174"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a175"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a176"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a177"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;We&nbsp;got&nbsp;a&nbsp;connection&nbsp;with&nbsp;a&nbsp;user&nbsp;client&nbsp;through&nbsp;dpclient.php,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a178"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;dpclient.php&nbsp;should&nbsp;send&nbsp;some&nbsp;serialized&nbsp;arrays&nbsp;with&nbsp;variables.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a179"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;These&nbsp;are&nbsp;the&nbsp;PHP&nbsp;global&nbsp;$_SERVER,&nbsp;$_COOKIE,&nbsp;...&nbsp;arrays.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a180"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;All&nbsp;client&nbsp;info,&nbsp;including&nbsp;input&nbsp;and&nbsp;AJAX&nbsp;parameters,&nbsp;are&nbsp;send</span></div></li>
<li class="src-li"><div class="src-line"><a name="a181"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;through&nbsp;these&nbsp;arrays.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a182"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a183"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$allbuf&nbsp;</span>=&nbsp;<span class="src-str">''</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a184"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a185"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SOCKET_TYPE">DPSERVER_SOCKET_TYPE</a>&nbsp;</span>===&nbsp;<span class="src-id">AF_UNIX</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a186"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Read&nbsp;in&nbsp;what&nbsp;dpclient.php&nbsp;is&nbsp;telling&nbsp;us&nbsp;in&nbsp;chunks&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a187"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$buf&nbsp;</span>=&nbsp;<a href="http://www.php.net/socket_read">socket_read</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a188"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SERVER_CHUNK">DPSERVER_SERVER_CHUNK</a></span><span class="src-sym">,&nbsp;</span><span class="src-id">PHP_NORMAL_READ</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a189"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a190"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;socket_read():&nbsp;failure&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a191"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a192"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a193"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break&nbsp;</span><span class="src-num">2</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a194"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a195"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$buf&nbsp;</span>=&nbsp;<a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$buf</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a196"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">continue</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a197"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a198"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;shutdown&nbsp;the&nbsp;server&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a199"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-var">$buf&nbsp;</span>==&nbsp;<span class="src-str">'shutdown'</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a200"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_close">socket_close</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a201"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break&nbsp;</span><span class="src-num">2</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a202"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a203"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a204"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a205"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Read&nbsp;the&nbsp;2KB&nbsp;blocks&nbsp;until&nbsp;dpclient.php&nbsp;sends&nbsp;us&nbsp;a&nbsp;'quit'</span></div></li>
<li class="src-li"><div class="src-line"><a name="a206"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a207"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-var">$buf&nbsp;</span>&lt;&gt;&nbsp;<span class="src-str">'quit'</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a208"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$allbuf&nbsp;</span>.=&nbsp;<span class="src-var">$buf</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a209"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">continue</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a210"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a211"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">else&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a212"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Read&nbsp;in&nbsp;what&nbsp;dpclient.php&nbsp;is&nbsp;telling&nbsp;us&nbsp;in&nbsp;chunks&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a213"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$buf&nbsp;</span>=&nbsp;<a href="http://www.php.net/socket_read">socket_read</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a214"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_SERVER_CHUNK">DPSERVER_SERVER_CHUNK</a></span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a215"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span></div></li>
<li class="src-li"><div class="src-line"><a name="a216"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-str">&quot;socket_read():&nbsp;failure&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a217"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a218"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a219"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break&nbsp;</span><span class="src-num">2</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a220"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a221"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$buf&nbsp;</span>=&nbsp;<a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$buf</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a222"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">continue</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a223"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a224"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$allbuf&nbsp;</span>.=&nbsp;<span class="src-var">$buf</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a225"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a226"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;shutdown&nbsp;the&nbsp;server&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a227"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">)&nbsp;</span>&gt;=&nbsp;<span class="src-num">7&nbsp;</span>&amp;&amp;</div></li>
<li class="src-li"><div class="src-line"><a name="a228"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">,&nbsp;</span>-<span class="src-num">7</span><span class="src-sym">)&nbsp;</span>==&nbsp;<span class="src-str">'shutdown'</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a229"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_close">socket_close</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a230"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break&nbsp;</span><span class="src-num">2</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a231"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a232"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a233"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a234"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Read&nbsp;the&nbsp;2KB&nbsp;blocks&nbsp;until&nbsp;dpclient.php&nbsp;sends&nbsp;us&nbsp;a&nbsp;'quit'</span></div></li>
<li class="src-li"><div class="src-line"><a name="a235"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a236"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">)&nbsp;</span>&lt;&nbsp;<span class="src-num">4&nbsp;</span>||&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">,&nbsp;</span>-<span class="src-num">4</span><span class="src-sym">)&nbsp;</span>!=&nbsp;<span class="src-str">'quit'</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a237"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">continue</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a238"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a239"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//$allbuf&nbsp;=&nbsp;substr($allbuf,&nbsp;0,&nbsp;strlen($allbuf&nbsp;-&nbsp;4));</span></div></li>
<li class="src-li"><div class="src-line"><a name="a240"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a241"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*&nbsp;Check&nbsp;for&nbsp;invalid&nbsp;input&nbsp;from&nbsp;dpclient.php&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a242"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">)&nbsp;</span>&lt;=&nbsp;<span class="src-num">6</span></div></li>
<li class="src-li"><div class="src-line"><a name="a243"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;<span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$pos1&nbsp;</span>=&nbsp;<a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;&lt;vars&gt;&quot;</span><span class="src-sym">))</span></div></li>
<li class="src-li"><div class="src-line"><a name="a244"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;<span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-sym">(</span><span class="src-var">$pos2&nbsp;</span>=&nbsp;<a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">,&nbsp;</span><span class="src-str">&quot;&lt;/vars&gt;&quot;</span><span class="src-sym">))</span></div></li>
<li class="src-li"><div class="src-line"><a name="a245"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;<span class="src-var">$pos2&nbsp;</span>&lt;=&nbsp;<span class="src-var">$pos1&nbsp;</span>+&nbsp;<span class="src-num">7</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a246"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<span class="src-str">'allbuf:&nbsp;'&nbsp;</span>.&nbsp;<span class="src-var">$allbuf&nbsp;</span>.&nbsp;<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a247"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a248"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a249"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a250"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a251"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Cut&nbsp;out&nbsp;and&nbsp;unserialize&nbsp;the&nbsp;three&nbsp;global&nbsp;PHP&nbsp;vars</span></div></li>
<li class="src-li"><div class="src-line"><a name="a252"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;dpclient.php&nbsp;passed&nbsp;on</span></div></li>
<li class="src-li"><div class="src-line"><a name="a253"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a254"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$vars&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$allbuf</span><span class="src-sym">,&nbsp;</span><span class="src-num">0</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pos2</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a255"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$vars&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$vars</span><span class="src-sym">,&nbsp;</span><span class="src-var">$pos1&nbsp;</span>+&nbsp;<span class="src-num">6</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a256"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">TRUE&nbsp;</span>===&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_BASE64_CLIENT2SERVER">DPSERVER_BASE64_CLIENT2SERVER</a></span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a257"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$vars&nbsp;</span>=&nbsp;<a href="http://www.php.net/base64_decode">base64_decode</a><span class="src-sym">(</span><span class="src-var">$vars</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a258"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a259"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$tmp&nbsp;</span>=&nbsp;<a href="http://www.php.net/unserialize">unserialize</a><span class="src-sym">(</span><span class="src-var">$vars</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a260"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<span class="src-var">$tmp</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a261"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//$handle&nbsp;=&nbsp;fopen('/tmp/dpserver.log',&nbsp;'a');</span></div></li>
<li class="src-li"><div class="src-line"><a name="a262"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//fwrite($handle,&nbsp;sprintf(dptext(&quot;No&nbsp;unserialize:&nbsp;%s\n&quot;),</span></div></li>
<li class="src-li"><div class="src-line"><a name="a263"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//$vars));</span></div></li>
<li class="src-li"><div class="src-line"><a name="a264"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">//fclose($handle);</span></div></li>
<li class="src-li"><div class="src-line"><a name="a265"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;No&nbsp;unserialize:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><span class="src-var">$vars</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a266"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$__SERVER&nbsp;</span>=&nbsp;<span class="src-var">$__SESSION&nbsp;</span>=&nbsp;<span class="src-var">$__COOKIE&nbsp;</span>=&nbsp;<span class="src-var">$__GET&nbsp;</span>=&nbsp;<span class="src-var">$__POST&nbsp;</span>=</div></li>
<li class="src-li"><div class="src-line"><a name="a267"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$__FILES&nbsp;</span>=&nbsp;<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a268"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a269"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a270"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list<span class="src-sym">(</span><span class="src-var">$__SERVER</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__SESSION</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__COOKIE</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__GET</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__POST</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a271"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$__FILES</span><span class="src-sym">)&nbsp;</span>=&nbsp;<span class="src-var">$tmp</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a272"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a273"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Pass&nbsp;on&nbsp;the&nbsp;request&nbsp;to&nbsp;the&nbsp;universe&nbsp;object.&nbsp;The&nbsp;universe</span></div></li>
<li class="src-li"><div class="src-line"><a name="a274"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;object&nbsp;can&nbsp;response&nbsp;by&nbsp;calling&nbsp;tellCurrentDpUserRequest()</span></div></li>
<li class="src-li"><div class="src-line"><a name="a275"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;below</span></div></li>
<li class="src-li"><div class="src-line"><a name="a276"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a277"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$universe</span><span class="src-sym">-&gt;</span><span class="src-id">handleCurrentDpUserRequest</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__SERVER</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a278"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$__SESSION</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__COOKIE</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__GET</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__POST</span><span class="src-sym">,&nbsp;</span><span class="src-var">$__FILES</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a279"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a280"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-comm">/*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a281"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;:KLUDGE:&nbsp;Shows&nbsp;server&nbsp;status&nbsp;once&nbsp;in&nbsp;a&nbsp;while.&nbsp;The&nbsp;ticks</span></div></li>
<li class="src-li"><div class="src-line"><a name="a282"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;system&nbsp;or&nbsp;external&nbsp;cron&nbsp;triggered&nbsp;calls&nbsp;should&nbsp;be&nbsp;used&nbsp;in&nbsp;the</span></div></li>
<li class="src-li"><div class="src-line"><a name="a283"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;future</span></div></li>
<li class="src-li"><div class="src-line"><a name="a284"></a><span class="src-comm">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a285"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-num">1&nbsp;</span>===&nbsp;<a href="http://www.php.net/mt_rand">mt_rand</a><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">,&nbsp;</span><span class="src-num">2&nbsp;</span>+&nbsp;<span class="src-var">$universe</span><span class="src-sym">-&gt;</span><span class="src-id">getNrOfUsers</span><span class="src-sym">(</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a286"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">_showStatus</span><span class="src-sym">(</span><span class="src-var">$universe</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a287"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a288"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">break</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a289"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">while&nbsp;</span><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a290"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_close">socket_close</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a291"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">while&nbsp;</span><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a292"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a293"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_close">socket_close</a><span class="src-sym">(</span><span class="src-var">$sock</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a294"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a295"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a296"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a297"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Tells&nbsp;a&nbsp;string&nbsp;to&nbsp;the&nbsp;current&nbsp;user&nbsp;request&nbsp;through&nbsp;dpclient.php</span></div></li>
<li class="src-li"><div class="src-line"><a name="a298"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a299"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Called&nbsp;from&nbsp;'the&nbsp;universe'&nbsp;to&nbsp;talk&nbsp;back&nbsp;to&nbsp;the&nbsp;client,&nbsp;messages&nbsp;are</span></div></li>
<li class="src-li"><div class="src-line"><a name="a300"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;typically&nbsp;XML&nbsp;with&nbsp;something&nbsp;like&nbsp;'&lt;message&gt;Lennert&nbsp;says:&nbsp;hi&lt;/message&gt;'.</span></div></li>
<li class="src-li"><div class="src-line"><a name="a301"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a302"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@param&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">string&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;</span><span class="src-doc-var">$talkback&nbsp;</span><span class="src-doc">&nbsp;&nbsp;String&nbsp;to&nbsp;send&nbsp;to&nbsp;current&nbsp;user&nbsp;client</span></div></li>
<li class="src-li"><div class="src-line"><a name="a303"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a304"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">function&nbsp;</span><a href="../DutchPIPE/lib/DpServer.html#methodtellCurrentDpUserRequest">tellCurrentDpUserRequest</a><span class="src-sym">(</span><span class="src-var">$talkback</span><span class="src-sym">)</span></div></li>
<li class="src-li"><div class="src-line"><a name="a305"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a306"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-num">0&nbsp;</span>===&nbsp;<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$talkback</span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a307"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a308"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a309"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a310"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">TRUE&nbsp;</span>===&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_BASE64_SERVER2CLIENT">DPSERVER_BASE64_SERVER2CLIENT</a></span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a311"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$talkback&nbsp;</span>=&nbsp;<a href="http://www.php.net/base64_encode">base64_encode</a><span class="src-sym">(</span><span class="src-var">$talkback</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a312"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a313"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$talkback&nbsp;</span>.=&nbsp;<a href="http://www.php.net/chr">chr</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a314"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a315"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id">FALSE&nbsp;</span>===&nbsp;<a href="http://www.php.net/socket_write">socket_write</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mMsgsock</span><span class="src-sym">,&nbsp;</span><span class="src-var">$talkback</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a316"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$talkback</span><span class="src-sym">)))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a317"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;socket_write():&nbsp;failure&nbsp;[%u]:&nbsp;%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a318"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/socket_strerror">socket_strerror</a><span class="src-sym">(</span><a href="http://www.php.net/socket_last_error">socket_last_error</a><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a319"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a320"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a321"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a322"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a323"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Shows&nbsp;some&nbsp;server&nbsp;info&nbsp;on&nbsp;the&nbsp;command&nbsp;line</span></div></li>
<li class="src-li"><div class="src-line"><a name="a324"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a325"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@param&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">object&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;</span><span class="src-doc-var">&amp;$universe&nbsp;</span><span class="src-doc">&nbsp;An&nbsp;instance&nbsp;of&nbsp;DpUniverse</span></div></li>
<li class="src-li"><div class="src-line"><a name="a326"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a327"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-key">function&nbsp;</span><span class="src-id">_showStatus</span><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$universe</span><span class="src-sym">)</span></div></li>
<li class="src-li"><div class="src-line"><a name="a328"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a329"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_DEBUG_TYPE_MEMORY_GET_USAGE">DPSERVER_DEBUG_TYPE_MEMORY_GET_USAGE</a>&nbsp;</span>===&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_DEBUG_TYPE">DPSERVER_DEBUG_TYPE</a></span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a330"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">_showStatusMemoryGetUsage</span><span class="src-sym">(</span><span class="src-var">$universe</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a331"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}&nbsp;</span><span class="src-key">elseif&nbsp;</span><span class="src-sym">(</span><span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_DEBUG_TYPE_GETRUSAGE">DPSERVER_DEBUG_TYPE_GETRUSAGE</a>&nbsp;</span>===&nbsp;<span class="src-id"><a href="../DutchPIPE/config/_config---dpserver-ini.php.html#defineDPSERVER_DEBUG_TYPE">DPSERVER_DEBUG_TYPE</a></span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a332"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">_showStatusMemoryGetrusage</span><span class="src-sym">(</span><span class="src-var">$universe</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a333"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a334"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a335"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a336"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a337"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Shows&nbsp;a&nbsp;line&nbsp;with&nbsp;memory&nbsp;and&nbsp;universe&nbsp;info</span></div></li>
<li class="src-li"><div class="src-line"><a name="a338"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a339"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@param&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">object&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;</span><span class="src-doc-var">&amp;$universe&nbsp;</span><span class="src-doc">&nbsp;An&nbsp;instance&nbsp;of&nbsp;DpUniverse</span></div></li>
<li class="src-li"><div class="src-line"><a name="a340"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a341"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-key">function&nbsp;</span><span class="src-id">_showStatusMemoryGetUsage</span><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$universe</span><span class="src-sym">)</span></div></li>
<li class="src-li"><div class="src-line"><a name="a342"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a343"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/function_exists">function_exists</a><span class="src-sym">(</span><span class="src-str">'memory_get_usage'</span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a344"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a345"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a346"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a347"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$info&nbsp;</span>=&nbsp;<span class="src-var">$universe</span><span class="src-sym">-&gt;</span><span class="src-id">getUniverseInfo</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a348"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a349"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-id">print_f</span><span class="src-sym">(</span><span class="src-str">&quot;Memory:&nbsp;%uKB&nbsp;KB&nbsp;&nbsp;#Objects:&nbsp;%u&nbsp;&nbsp;#Users:&nbsp;%u&nbsp;&nbsp;#Environments:&nbsp;%u&nbsp;&nbsp;&quot;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a350"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;<span class="src-str">&quot;#Timeouts:&nbsp;%u\n&quot;</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a351"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/round">round</a><span class="src-sym">(</span><span class="src-var">$info</span><span class="src-sym">[</span><span class="src-str">'memory_usage'</span><span class="src-sym">]&nbsp;</span>/&nbsp;<span class="src-num">1024</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a352"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/sizeof">sizeof</a><span class="src-sym">(</span><span class="src-var">$info</span><span class="src-sym">[</span><span class="src-str">'nr_of_objects'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a353"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/sizeof">sizeof</a><span class="src-sym">(</span><span class="src-var">$info</span><span class="src-sym">[</span><span class="src-str">'nr_of_users'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a354"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/sizeof">sizeof</a><span class="src-sym">(</span><span class="src-var">$info</span><span class="src-sym">[</span><span class="src-str">'nr_of_environments'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a355"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/sizeof">sizeof</a><span class="src-sym">(</span><span class="src-var">$info</span><span class="src-sym">[</span><span class="src-str">'nr_of_timeouts'</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a356"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a357"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a358"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-doc">/**</span></div></li>
<li class="src-li"><div class="src-line"><a name="a359"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Shows&nbsp;a&nbsp;line&nbsp;with&nbsp;getrusage&nbsp;info,&nbsp;see&nbsp;man&nbsp;getrusage</span></div></li>
<li class="src-li"><div class="src-line"><a name="a360"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></div></li>
<li class="src-li"><div class="src-line"><a name="a361"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="src-doc-coretag">@param&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="src-doc-type">object&nbsp;</span><span class="src-doc">&nbsp;&nbsp;&nbsp;</span><span class="src-doc-var">&amp;$universe&nbsp;</span><span class="src-doc">&nbsp;An&nbsp;instance&nbsp;of&nbsp;DpUniverse</span></div></li>
<li class="src-li"><div class="src-line"><a name="a362"></a><span class="src-doc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div></li>
<li class="src-li"><div class="src-line"><a name="a363"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">private&nbsp;</span><span class="src-key">function&nbsp;</span><span class="src-id">_showStatusMemoryGetrusage</span><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$universe</span><span class="src-sym">)</span></div></li>
<li class="src-li"><div class="src-line"><a name="a364"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a365"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/function_exists">function_exists</a><span class="src-sym">(</span><span class="src-str">'getrusage'</span><span class="src-sym">))&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a366"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">return</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a367"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a368"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a369"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$dat&nbsp;</span>=&nbsp;<a href="http://www.php.net/getrusage">getrusage</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a370"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a371"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$utime_after&nbsp;</span>=&nbsp;(int)<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_utime.tv_sec&quot;</span><span class="src-sym">]</span>*<span class="src-num">1e6&nbsp;</span>+</div></li>
<li class="src-li"><div class="src-line"><a name="a372"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(int)<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_utime.tv_usec&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a373"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$stime_after&nbsp;</span>=&nbsp;(int)<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_stime.tv_sec&quot;</span><span class="src-sym">]</span>*<span class="src-num">1e6&nbsp;</span>+</div></li>
<li class="src-li"><div class="src-line"><a name="a374"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(int)<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_stime.tv_usec&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a375"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a376"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_utime&quot;</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/number_format">number_format</a><span class="src-sym">((</span><span class="src-var">$utime_after&nbsp;</span>-&nbsp;<span class="src-var">$utime_before</span><span class="src-sym">)&nbsp;</span>/</div></li>
<li class="src-li"><div class="src-line"><a name="a377"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-num">1000000</span><span class="src-sym">,&nbsp;</span><span class="src-num">2</span><span class="src-sym">)&nbsp;</span>.&nbsp;<span class="src-str">'s'</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a378"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_stime&quot;</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/number_format">number_format</a><span class="src-sym">((</span><span class="src-var">$stime_after&nbsp;</span>-&nbsp;<span class="src-var">$stime_before</span><span class="src-sym">)&nbsp;</span>/</div></li>
<li class="src-li"><div class="src-line"><a name="a379"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-num">1000000</span><span class="src-sym">,&nbsp;</span><span class="src-num">2</span><span class="src-sym">)&nbsp;</span>.&nbsp;<span class="src-str">'s'</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a380"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_maxrss&quot;</span><span class="src-sym">]&nbsp;</span>=&nbsp;<span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">&quot;ru_maxrss&quot;</span><span class="src-sym">]&nbsp;</span>.&nbsp;<span class="src-str">'kb'</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a381"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_oublock'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a382"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_inblock'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a383"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_nswap'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a384"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_nsignals'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a385"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_utime.tv_sec'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a386"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_utime.tv_usec'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a387"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_stime.tv_sec'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a388"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset<span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">[</span><span class="src-str">'ru_stime.tv_usec'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a389"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a390"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><span class="src-num">0&nbsp;</span>===&nbsp;(int)<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mShowedStatusHeader</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a391"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$keys&nbsp;</span>=&nbsp;<a href="http://www.php.net/array_keys">array_keys</a><span class="src-sym">(</span><span class="src-var">$dat</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a392"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">foreach&nbsp;</span><span class="src-sym">(</span><span class="src-var">$keys&nbsp;</span><span class="src-key">as&nbsp;</span><span class="src-var">$i&nbsp;</span>=&gt;&nbsp;<span class="src-var">$k</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a393"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$keys</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$keys</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-num">3</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a394"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-key">if&nbsp;</span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$keys</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">)&nbsp;</span>&gt;&nbsp;<span class="src-num">7</span><span class="src-sym">)&nbsp;</span><span class="src-sym">{</span></div></li>
<li class="src-li"><div class="src-line"><a name="a395"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$keys</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]&nbsp;</span>=&nbsp;<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$keys</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">,&nbsp;</span><span class="src-num">0</span><span class="src-sym">,&nbsp;</span><span class="src-num">7</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a396"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a397"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a398"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mShowedStatusHeader&nbsp;</span>=&nbsp;<span class="src-num">30</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a399"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a400"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;Memory\t%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/implode">implode</a><span class="src-sym">(</span><span class="src-str">&quot;\t&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$keys</span><span class="src-sym">))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a401"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a402"></a>&nbsp;</div></li>
<li class="src-li"><div class="src-line"><a name="a403"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><a href="../DutchPIPE/lib/_lib---dptext.php.html#functiondptext">dptext</a><span class="src-sym">(</span><span class="src-str">&quot;%uKB\t%s\n&quot;</span><span class="src-sym">)</span><span class="src-sym">,&nbsp;</span><a href="http://www.php.net/round">round</a><span class="src-sym">(</span><a href="http://www.php.net/memory_get_usage">memory_get_usage</a><span class="src-sym">(</span><span class="src-sym">)&nbsp;</span>/&nbsp;<span class="src-num">1024</span><span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li class="src-li"><div class="src-line"><a name="a404"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.php.net/implode">implode</a><span class="src-sym">(</span><span class="src-str">&quot;\t&quot;</span><span class="src-sym">,&nbsp;</span><span class="src-var">$dat</span><span class="src-sym">))</span><span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a405"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">mShowedStatusHeader</span>--<span class="src-sym">;</span></div></li>
<li class="src-li"><div class="src-line"><a name="a406"></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a407"></a><span class="src-sym">}</span></div></li>
<li class="src-li"><div class="src-line"><a name="a408"></a><span class="src-php">?&gt;</span></div></li>
</ol>
</span></div>
        <div class="credit">
		    <hr class="separator" />
		    Documentation generated on Sun, 13 Aug 2006 20:43:29 +0200 by <a href="http://www.phpdoc.org">phpDocumentor 1.3.0RC6</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>
